\documentclass[titlepage]{report}

\usepackage{titlesec}
\usepackage{lipsum}
\usepackage{graphicx}
\usepackage{wrapfig}
\usepackage[export]{adjustbox}
\usepackage[dvipsnames]{xcolor}
\usepackage{colortbl}

%setting for chapter font
\titleformat{\chapter}[display]
  {\Huge\bfseries}{}{1pt}{\Huge}
  
  

\title{\textbf{Milestone 1}}  


\begin{document}
%\maketitle

\tableofcontents{}
\newpage

\chapter{Plan for Milestone 1}
In this phase,there were three main objectives. The first objective was to develop and test a plugin for OpenVINO and the second objective was to generate kernel codes (in order to run a simple CNN topology on a single FPGA) using Tensor Virtual Machine (TVM). 
The third objective was to customize TVM codes for the above mentioned plugin and to synthesize the codes for Stratix 10 board.



\chapter{Development of OpenVINO Plugin}
The development of OpenVino Plugin is a crucial objective of our project.This chapter contains the steps taken to create the first version of the plugin. This chapter also describes the tasks which were not completed (partially or completely). 
\subsection{Plugin development}
\begin{itemize}
\item The Deep Learning Deployment Toolkit (dldt) github repository was integrated into the university gitlab server. 
\item A folder named Noctua\_plugin was created inside dldt and another folder named kernels was created inside Nocuta\_plugin to store the bitstreams (.aocx files).
\item The development process started by editing the classification sample application to parse the IR of the given input topology. 
\item This parsed IR, which is stored in a data structure called CNNNetwork, is then passed on to the plugin. 
\item A single file named fpga\_plugin.cpp retrieved the layer information from the IR, launched the kernels on the FPGA after passing them the required arguments.
\item Caffe was used as the framework to generate protobuf file. OpenVINO does not support Tensorflow or Caffe 2.
\item A customized Simple CNN kernel code (AOCL file) was used to test the plugin.
\item A single MNIST PNG file was used to test the launching capabilities of OpenVino. The image was correctly classified on emulator. Binary image files are not compatible with OpenVino. Thus , images in PNG format are passed to the plugin.
\item OpenVino supports only PNG format images. Due to time constraints, only one PNG image was tested. Testing with more images is needed and will be done in Milestone 2.
 
\end{itemize} 




\chapter{Using TVM to generate kernels}
Tensor Virtual Machine(TVM) is being used as a code generator. This chapter describes the steps taken to setup the TVM tool and to generate kernel codes. This chapter also contains the tasks which were not completed.
\subsection{Development}
\begin{itemize}
    \item Relay is imported which helps provide intermediate representation (IR) for the model.
    \item Tensorfow or caffe model (protobuf file) is imported and graph definition is created from the file with the help of tensorflow GraphDef class.
    \item On creating graph definition, it is imported into relay frontend to generate relay expression and parameters from tensorflow protobuf file. 
    \item The expression and parameters along with target host (OpenCL) are parsed to relay build function to create the final graph. 
\end{itemize}




\chapter{ Customizing TVM generated kernels}  

\subsection{Custom code}
\begin{itemize}
    \item The third objective was to customize and synthesize the kernel code generated by TVM to suit the needs of OpenVino plugin.
    \item  A kernel code compatible with OpenVino was written manually because we were not able to use TVM to generate kernel codes for Simple CNN.
    
\end{itemize}


\chapter{Problems faced}
\begin{itemize}
    
\item TVM does not support custom models due to which kernels could not be generated.

\item And due to the above-mentioned issue of TVM, hand-built kernel code file was used for launching kernels through the OpenVINO plugin. 

\item And also, the plugin was tested on an emulator. 

\item Since kernels codes for CNN could not be generated using TVM, the idea of CNN model has been scrapped and the focus is now on GoogleNet.

\item Hence, generation of kernel code using TVM and the customization and synthesis of the kernel code on stratix 10 will be achieved in the early stages of milestone 2.

    

\end{itemize}






\chapter{Conclusion}
To summarize, not all the objectives as per the plan were achieved in milestone 1. 
\begin{itemize}
\item As discussed, a plugin was successfully developed for OpenVINO and the developed plugin supports convolution, max pooling and fully connected layers as required by the simpleCNN topology.

\item The final graph created in TVM is used to generate the OpenCL code.

\item However, kernel codes for CNN were not generated using TVM due to the fact that TVM does not support custom models.
\item Hence, the focus has now shifted to GoogleNet, which will be achieved in milestone 2.


   
\end{itemize}



\end{document}
